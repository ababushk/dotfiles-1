#!/bin/bash

function has-frame {
    emacsclient -n -e "(plusp (length (remove-if (lambda (x) \
                                                         (null (window-system x))) \
                                                 (frame-list))))"
}

function new-frame {
    emacsclient -c -n -a "" "$@"
}

function open-frame {
    emacsclient -n -a "" "$@"
}

function raise-frame {
    open-frame \
        -e "(raise-frame (car (remove-if (lambda (x) \
                                                 (null (window-system x))) \
                                         (frame-list))))"
}

if [ `has-frame` == "t" ]; then
    open-frame "$@" 2> /dev/null || raise-frame

else
    new-frame "$@"
fi
